const {
  Events,
  ActionRowBuilder,
  ButtonBuilder,
  ButtonStyle,
  EmbedBuilder,
} = require('discord.js');

const apply = require('../../commands/admin/apply');

module.exports = {
  name: Events.InteractionCreate,

  /**
   * @param {import('discord.js').Interaction} interaction
   * @param {import('discord.js').Client} client
   */
  async execute(interaction, client) {
    try {
      if (interaction.isChatInputCommand()) {
        const command = client.commands.get(interaction.commandName);
        if (!command) {
          return await interaction.reply({
            content: `โ๏ธ ูู ูุชู ุงูุนุซูุฑ ุนูู ุงูุฃูุฑ \`${interaction.commandName}\`.`,
            flags: 64,
          });
        }
        await command.execute(interaction, client);

      } else if (interaction.isAutocomplete()) {
        const command = client.commands.get(interaction.commandName);
        if (command?.autocomplete) {
          await command.autocomplete(interaction, client);
        }

      } else if (interaction.isButton()) {
        const { customId } = interaction;

        if (
          customId.startsWith('apply') ||
          customId === 'create_kingdom' ||
          customId === 'join_kingdom' ||
          customId === 'approve_application' ||
          customId === 'reject_application' ||
          customId.startsWith('close_ticket_')
        ) {
          await apply.buttonHandler(interaction, client);
          return;
        }

        if (customId === 'map_rules') {
          const embed = new EmbedBuilder()
            .setColor('#3BA55D')
            .setTitle('๐บ๏ธ ููุงููู ุงูุฎุฑูุทุฉ ูุงูุงุณุชุนูุงุฑ (ุงููุฑุญูุฉ ุงูุงุณุชุฑุงุชูุฌูุฉ)')
            .setDescription(`ููุงููู ุงูุฎุฑูุทุฉ ูุงูุงุณุชุนูุงุฑ (ุงููุฑุญูุฉ ุงูุงุณุชุฑุงุชูุฌูุฉ)

โธป

๐บ๏ธ 1. ุงูุฎุฑูุทุฉ ุงูููุญุฏุฉ:
    โข    ูุจุฏุฃ ุงููุธุงู ุจุฎุฑูุทุฉ ูุจูุฑุฉุ ููุญุฏุฉ ุงููููุ ุฎุงููุฉ ูู ุฃู ุชูุณูู ุฃู ุณูุทุฑุฉ.
    โข    ุชูุซู ูุฐู ุงูุฎุฑูุทุฉ ุฃุฑุถูุง ุฎุงููุง ุณูุชู ุงุณุชุนูุงุฑูุง ูู ูุจู ุงูููุงูู.

โธป

๐ฐ 2. ุงุฎุชูุงุฑ ุงููุฆุฉ ูุชุญุฏูุฏ ุงูููููุฉ:
    โข    ูู ููููุฉ ูุชู ุฅูุดุงุคูุง ุจูุงุกู ุนูู ูุฆุฉ ูุชู ุงุฎุชูุงุฑูุง ูุณุจููุง.
    โข    ุงููุฆุฉ ุชุญุฏุฏ:
    โข    ุงุณู ุงูููููุฉ (ููุดุชู ูู ุงููุฆุฉ ูุจุงุดุฑุฉ).
    โข    ููุน ุงูุจูุฆุฉ (ุฌููุฏูุฉุ ุตุญุฑุงููุฉุ ุจุฑูุงููุฉุ ุฅูุฎ).
    โข    ุงูุฎุตุงุฆุต ุงูุฎุงุตุฉ ุจุงูููููุฉ.
    โข    ุงูููู ุงูุฑุณูู ููููููุฉ ุนูู ุงูุฎุฑูุทุฉ.
    โข    ุงููุฏุฑุงุช ุงูุฎุงุตุฉ ุงูุชู ุชูุณุชุฎุฏู ูู ุงูุญุฑูุจ.

โธป

๐ 3. ุชุญุฏูุฏ ูููุน ุงูุจุฏุงูุฉ:
    โข    ุชุฎุชุงุฑ ูู ููููุฉ ูุทุนุฉ ุฃุฑุถ ูุงุญุฏุฉ ูุจุฏุงูุฉ.
    โข    ุชููููู ูุฐู ุงููุทุนุฉ ุจููู ุงูููููุฉ.

โธป

โ 4. ูุฑุญูุฉ ุงูุณูุงู ุงููุคูุช:
    โข    ูููุน ุงููุฌูู ุฃู ุงูุชุฏุฎู ุจูู ุงูููุงูู ุฎูุงู ูุฑุญูุฉ ุงูุชูุณูุน.
    โข    ุชุณุชูุฑ ุญุชู ุชููุณู ุงูุฎุฑูุทุฉ ุจุงููุงูู ุจูู ุงูููุงูู.
    โข    ุชุชูุญ ููููุงูู ุจูุงุก ุงุณุชุฑุงุชูุฌูุงุชูุง ุฏูู ุชูุฏูุฏ.

โธป

๐ฐ 5. ุงูุงุณุชุนูุงุฑ ูุชูุณูุน ุงููููุฐ:
    โข    ุนูุฏ ุชุฌููุน ุนุฏุฏ ูุนูู ูู ุนููุงุช GGC (Gold Crowns Coins)ุ ูููู ุงุณุชุนูุงุฑ ุฃุฑุงุถู ุฌุฏูุฏุฉ.
    โข    ุงูุฃุฑุงุถู ุงูุฌุฏูุฏุฉ ุชูุถุงู ูุญุฏูุฏ ุงูููููุฉ ูุชููููู ุจููููุง ุงูุฑุณูู.

โธป

๐ 6. ูุธุงู ุงูุนููุงุช โ GGC (Gold Crowns Coins):

ุนููุฉ GGC ูู ุงูุนููุฉ ุงูุฑุณููุฉ ูู ุงููุธุงูุ ูุชูุณุชุฎุฏู ูู:
    โข    ุชุทููุฑ ุงููุฆุฉ ูุงููุฏุฑุงุช.
    โข    ูุชุญ ุฑููุงุช ุตูุชูุฉ ุฃู ูุชุงุจูุฉ.
    โข    ุฏูุน ุชูุงููู ุงูุชุญุงููุงุช.
    โข    ุงูุญุตูู ุนูููุง ูุชู ุนุจุฑ:
    โข    2500 XP ุตูุชู = 1 ุนููุฉ
    โข    1200 XP ูุชุงุจู = 1 ุนููุฉ
    โข    ุงูููุฒ ุจุงูุญุฑูุจ = ุนุฏุฏ ูุนูู ูู ุงูุนููุงุช
    โข    ุชูุญุณุจ ุฃุณุจูุนููุง ุญุณุจ ุชูุงุนู ุงูููููุฉ.

โธป

๐ 7. ุงููุชุฌุฑ ุงูุฎุงุต ุจุงูููููุฉ:
    โข    ุจุงุณุชุฎุฏุงู ุนููุงุช GGCุ ูููู ููููููุฉ ุดุฑุงุก:
    โข    ุชุทููุฑุงุช ูููุฆุฉ.
    โข    ุฑููุงุช ุตูุชูุฉ ุฃู ูุชุงุจูุฉ ูุฎุตุตุฉ.
    โข    ุฅุถุงูุงุช ุชูุงุนููุฉ ูุฎุฏูุงุช ุฏุงุฎููุฉ.
`);

          await interaction.reply({ embeds: [embed], flags: 64 });

        } else if (customId === 'war_rules') {
          const embed = new EmbedBuilder()
            .setColor('#E03A3E')
            .setTitle('โ๏ธ ุงูุชุญุงููุงุช ูุงูุญุฑูุจ')
            .setDescription(`โ๏ธ ุงูุชุญุงููุงุช ูุงูุญุฑูุจ

โธป

8. ูุฑุญูุฉ ุงูุณูุงู ุงููุคูุช:
    โข    ููููุน ุงููุฌูู ุฃู ุดูู ุงูุญุฑูุจ ุจูู ุงูููุงูู ูู ุงููุฑุญูุฉ ุงูุฃููู.
    โข    ุชุณุชูุฑ ูุฐู ุงููุฑุญูุฉ ุญุชู ุชูุชูู ุงูุฎุฑูุทุฉ ุจุงููุงูู ูุชูุฒูุน ุงูุฃุฑุงุถู ุจูู ุฌููุน ุงูููุงูู.

โธป

9. ูุธุงู ุงูุชุญุงููุงุช:
    โข    ูููู ูุฃู ููููุชูู ุนูุฏ ุชุญุงูู ูููุน ุงููุฌูู ุจููููุง.
    โข    ูุณุฑ ุงูุชุญุงูู ูุณููุญุ ูููู:
    โข    ููุฎุตู ุนููุงุช ูู ุงูููููุฉ ุงูุชู ุชูุณุฑ ุงูุชุญุงูู.
    โข    ูููุญ ุฃูุถููุฉ ุฏูุงุนูุฉ ููุทุฑู ุงููุชุถุฑุฑ.
    โข    ูุนุชุจุฑ ุฎุทูุฉ ุงุณุชุฑุงุชูุฌูุฉ ูุญุณูุจุฉ.

โธป

10. ุงูุญุฑุจ ุงููุจุฑู:
    โข    ุชุจุฏุฃ ุงูุญุฑุจ ุงููุจุฑู ููุฑ ุงูุชูุงู ุงูุฎุฑูุทุฉ ุจุงููุงูู.
    โข    ููุณูุญ ุจุดูู ุงููุฌูุงุช ููุญุงููุงุช ุบุฒู ุฃุฑุงุถู ุงูููุงูู ุงูุฃุฎุฑู.
    โข    ูุง ูููู ุงููุฌูู ุนูู ููููุฉ ูุชุญุงููุฉ ุฅูุง ุจุนุฏ ูุณุฑ ุงูุชุญุงูู ุฑุณูููุง.

โธป

11. ูุธุงู ุงููุนุงุฑู:
    โข    ูู ูุนุฑูุฉ ุชุชูููู ูู 3 ุฌููุงุช:
    โข    ุฌููุชุงู ูุฎุชุงุฑ ููุนููุง ุงููุฏุงูุน.
    โข    ุฌููุฉ ูุงุญุฏุฉ ูุฎุชุงุฑูุง ุงูููุงุฌู.
    โข    ุงูุชุญุฏูุงุช ุชุดูู:
    โข    ุฃุณุฆูุฉ ุฐูููุฉ (ุฃูุบุงุฒุ ููุทูุ ูุนูููุงุช).
    โข    ุชุญุฏูุงุช ุณุฑุนุฉ.
    โข    ุฃูุนุงุจ ุจุณูุทุฉ ุฃู ุฅููุชุฑูููุฉ.
    โข    ูููู ุงุณุชุฎุฏุงู ูุฏุฑุฉ ุงููุฆุฉ ุงูุฎุงุตุฉ ูุฑุฉ ูุงุญุฏุฉ ููุท ูู ูู ุญุฑุจ.
    โข    ุงูููุฒ ุจุฌููุชูู = ุงูุชุตุงุฑ + ููุงูุฃุฉ ูู ุนููุงุช GGC.
`);
          await interaction.reply({ embeds: [embed], flags: 64 });

        } else if (customId === 'general_rules') {
          const embed = new EmbedBuilder()
            .setColor('#5865F2')
            .setTitle('๐ ุงูููุงููู ูุงูููุงุนุฏ ุงูุนุงูุฉ โ Kingdoms War')
            .setDescription(`๐ ุงูููุงููู ูุงูููุงุนุฏ ุงูุนุงูุฉ โ Kingdoms War

โธป

    1.    ุงูุงูุชุฒุงู ุจุงููุฒุงูุฉ:
    โข    ูููุน ุงูุบุด ููุญุงููุฉ ุงูุบุด ุจุฃู ุดูู.
    โข    ุงููุฎุงููุฉ ุชุนุฑุถ ุงูููููุฉ ูุงูุนุถู ูุนููุจุงุช ุชุตู ุฅูู ุฎุตู ููุงุท ูุนุฏู ูุดุงุฑูุฉ ุงูุนุถู ูู ุฃู ุญุฑูุจ ูุงุฏูุฉ.
    
    2.    ุงุญุชุฑุงู ุงูุชุญุงููุงุช:
    โข    ูููุน ูุณุฑ ุงูุชุญุงูู ุฏูู ุฅุนูุงู ุงูุฅุฏุงุฑุฉ ุฃู ุฅุนูุงู ุฑุณูู.
    โข    ูุณุฑู ุจุฏูู ุฐูู ููุนุชุจุฑ ูุฎุงููุฉ ูุชูุนุงูุจ ุนูููุง.
    
    3.    ุงูุชูุงุนู ูุงูุญุณุงุจุงุช:
    โข    ูููุน ุงุณุชุฎุฏุงู ุฃู ุญุณุงุจ ุบูุฑ ููุซูู ุฃู ููุฑุฑ.
    โข    ููุญุชุณุจ ุงูุชูุงุนู ุงูุญูููู ููุท.
    
    4.    ุงูุงุญุชุฑุงู ูุงูุจูุฆุฉ ุงูุชูุงูุณูุฉ:
    โข    ูููุน ููุนุง ุจุงุชุง ุฃุฎุฐ ุฃู ุดุฎุต ูู ููููุฉ ุฃุฎุฑู ุฅูู ููููุชู ุฏูู ุฅุฑุงุฏุชู ูุฏูู ุฅุนูุงู ุงููุฑูู ุงููุณุคูู.
    โข    ูุฌุจ ุฃู ุชููู ุงูุจูุฆุฉ ุชูุงูุณูุฉ ูุฎุงููุฉ ูู ุงููุดุงูู.
    โข    ูููุน ุงููุดุงูู ุจูู ุงูููุงูุงุช ูุงูุญุณุงุณูุฉ.
`);
          await interaction.reply({ embeds: [embed], flags: 64 });

        } else {
          await interaction.reply({
            content: 'โ ุฒุฑุงุฑ ุบูุฑ ูุนุฑูู.',
            flags: 64,
          });
        }

      } else if (interaction.isModalSubmit()) {
        await apply.modalHandler(interaction, client);
      }
    } catch (error) {
      console.error('Error handling interaction:', error);
      if (!interaction.replied && !interaction.deferred) {
        try {
          await interaction.reply({
            content: 'ุญุฏุซ ุฎุทุฃ ุบูุฑ ูุชููุนุ ูุฑุฌู ุงููุญุงููุฉ ูุงุญูุงู.',
            flags: 64,
          });
        } catch {}
      }
    }
  },
};
